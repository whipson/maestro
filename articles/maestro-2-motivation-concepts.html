<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="maestro">
<title>Motivation and Concepts • maestro</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Motivation and Concepts">
<meta property="og:description" content="maestro">
<meta property="og:image" content="https://whipson.github.io/maestro/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">maestro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/maestro-1-quick-start.html">Quick Start</a>
    <a class="dropdown-item" href="../articles/maestro-2-motivation-concepts.html">Motivation and Concepts</a>
    <a class="dropdown-item" href="../articles/maestro-3-use-cases.html">Use Cases</a>
    <a class="dropdown-item" href="../articles/maestro-4-advanced-scheduling.html">Advanced Scheduling</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/whipson/maestro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Motivation and Concepts</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/whipson/maestro/blob/HEAD/vignettes/maestro-2-motivation-concepts.Rmd" class="external-link"><code>vignettes/maestro-2-motivation-concepts.Rmd</code></a></small>
      <div class="d-none name"><code>maestro-2-motivation-concepts.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-is-maestro">What is maestro?<a class="anchor" aria-label="anchor" href="#what-is-maestro"></a>
</h2>
<p><code>maestro</code> is an R package for creating and orchestrating
many data pipelines in R. If you have several batch jobs/pipelines that
you want to schedule and monitor from within a single R project, then
<code>maestro</code> is for you. All you do is <em>decorate</em> R
functions with special <code>roxygen2</code> tags and then execute an
orchestrator script:</p>
</div>
<div class="section level2">
<h2 id="why-do-i-need-maestro">Why do I need maestro?<a class="anchor" aria-label="anchor" href="#why-do-i-need-maestro"></a>
</h2>
<p>Running data pipelines is an essential component of data engineering.
It is not unusual to have dozens of pipelines that need to run at
different frequencies, and when you go to deploy these pipelines
scheduling and monitoring them quickly becomes unwieldy. Perhaps you’ve
considered moving to heftier orchestration suites such as Airflow,
Dagster, and others which require learning entirely new skills and pose
their own challenges with deployment. <code>maestro</code> allows you to
orchestrate your pipelines entirely in R. All you then need is an
environment to deploy your <code>maestro</code> project.</p>
</div>
<div class="section level2">
<h2 id="pipelines">Pipelines<a class="anchor" aria-label="anchor" href="#pipelines"></a>
</h2>
<p>A pipeline is some process that takes raw data (often from an
external source) and moves it somewhere else often transforming it along
the way. Think of a pipeline as a factory assembly line where data is
the raw material. As this data travels along the pipeline, it undergoes
various transformations—such as cleaning, aggregation, and
analysis—making it increasingly refined and valuable. The refined
product is then stored in a new location where it can be used either by
an end consumer or another pipeline. The prototypical type of pipeline
in data engineering is ETL (<strong>E</strong>xtract,
<strong>T</strong>ransform, <strong>L</strong>oad), where data is
extracted from a source, transformed, then loaded into storage.</p>
<div class="section level3">
<h3 id="scheduled-batch-processing">Scheduled Batch Processing<a class="anchor" aria-label="anchor" href="#scheduled-batch-processing"></a>
</h3>
<p>The pipeline needs to run regularly and automatically to process new
data. Most analytic workloads undergo batch processing - the processing
of data in discrete timed batches. In scheduled batch processing, you as
the engineer decide how often you want your pipeline to run (every day
at 12:00?, every hour on the 15th minute?).</p>
<p>In <code>maestro</code> a pipeline is an R function with
<code>roxygen2</code> comments for scheduling and configuration:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' my_pipe maestro pipeline</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @maestroFrequency 1 day</span></span>
<span><span class="co">#' @maestroStartTime 2024-05-24</span></span>
<span></span>
<span><span class="va">my_pipe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">random_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    letters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    numbers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">random_data</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="orchestrator">Orchestrator<a class="anchor" aria-label="anchor" href="#orchestrator"></a>
</h2>
<p>An orchestrator is a process that triggers pipelines to run. Think of
it as the factory manager who turns on various assembly lines as needed.
It also monitors all the pipelines to ensure smooth operation. Just like
the factory manager, the orchestrator operates in “shifts” and so needs
to be scheduled to perform it’s job too.</p>
<div class="section level3">
<h3 id="rounded-scheduling">Rounded Scheduling<a class="anchor" aria-label="anchor" href="#rounded-scheduling"></a>
</h3>
<p>Importantly, <code>maestro</code> needs to know how often you’re
going to run the orchestrator. Unlike most orchestration tools out
there, <code>maestro</code> isn’t intended to be continuously running,
which saves you on compute resources. But this means that pipelines
won’t necessarily run <em>exactly</em> when they’re scheduled to. This
is a concept we call <em>rounded scheduling.</em></p>
<p>Let’s say we have a pipeline scheduled to run hourly on the 02 minute
mark (e.g., 01:02, 02:02, etc.), and our orchestrator runs every hour on
the 00 minute. When the orchestrator runs, it’ll be slightly before the
pipeline scheduled time, but it’ll trigger the pipeline anyway because
it’s close enough within the frequency of the orchestrator. If instead
our orchestrator ran every 15 minutes, it’d still only execute the
pipeline once in the hour. But if we underprovisioned the orchestrator
and ran it only every day, then the pipeline would only execute once a
day. So an important guideline is that the orchestrator needs to run at
least as frequency as your highest frequency pipeline.</p>
<p>In <code>maestro</code> an orchestrator is an R script or Quarto like
this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/whipson/maestro" class="external-link">maestro</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">schedule_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_schedule.html">build_schedule</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_schedule.html">run_schedule</a></span><span class="op">(</span></span>
<span>  <span class="va">schedule_table</span>,</span>
<span>  orch_frequency <span class="op">=</span> <span class="st">"1 hour"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>By passing the <code>orch_frequency = "1 hour"</code> to
<code><a href="../reference/run_schedule.html">run_schedule()</a></code>, we’re saying that we intend to run the
orchestrator every 1 hour.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-other-packages">Comparison with other packages<a class="anchor" aria-label="anchor" href="#comparison-with-other-packages"></a>
</h2>
<div class="section level3">
<h3 id="r-targets">{R} targets<a class="anchor" aria-label="anchor" href="#r-targets"></a>
</h3>
<p><a href="https://docs.ropensci.org/targets/index.html" class="external-link">targets</a> is
a “pipeline tool for statistics and data science in R”. If you have
multiple connected components of a pipeline, <code>targets</code> skips
computation of tasks that are up-to-date. <code>targets</code> seems to
be primarily used for projects with a single output (e.g., model,
document) where there are multiple steps that cumulatively take a long
time to complete. In contrast, <code>maestro</code> is focused on
projects with multiple <em>independent</em> pipelines. Moreover,
<code>maestro</code> pipelines are primarily used when the
<em>up-to-dateness</em> of the source data is unknown (e.g., coming from
an API or database), unlike in <code>targets</code> where it determines
the <em>up-to-dateness</em> based on the contents of a file.</p>
<p>That said, <code>targets</code> and <code>maestro</code> may be
complimentary in a single project. One possible case would be to use
<code>maestro</code> to orchestrate <code>targets</code> pipelines for
tasks such as ETL (e.g., <code>maestro</code> kicks off the pipeline but
then downstream computations are avoided if there’s no new data from
source). This is a possible exciting integration that we hope to
investigate further!</p>
</div>
<div class="section level3">
<h3 id="python-dagster">{Python} dagster<a class="anchor" aria-label="anchor" href="#python-dagster"></a>
</h3>
<p><a href="https://dagster.io/" class="external-link">Dagster</a> is an “open source
orchestration platform for the development, production, and observation
of data assets”. Like <code>maestro</code>, dagster uses decorators
(special comments) to configure <em>data assets</em> (functions). Unlike
<code>maestro</code>, dagster is primarily for chaining together
dependent components of a multi-step pipeline - a DAG. It also supports
a developer UI and is more fully developed than <code>maestro</code> at
the current time.</p>
<p>DAG support is something we’ve considered for <code>maestro</code>.
It seems feasible but would be a dramatic step up in the complexity of
the package. Conceivably, you could tag <code>maestro</code> pipelines
to form a dependency graph and then <code>maestro</code> would validate
the graph and coordinate the chaining and passing of data from one
component to the next.</p>
</div>
</div>
<div class="section level2">
<h2 id="when-to-not-use-maestro">When to not use maestro?<a class="anchor" aria-label="anchor" href="#when-to-not-use-maestro"></a>
</h2>
<p>While <code>maestro</code> can be used for almost any data
engineering task that can be performed in R, there are cases where it is
less appropriate to use it.</p>
<div class="section level3">
<h3 id="streaming-and-event-driven">Streaming and Event-driven<a class="anchor" aria-label="anchor" href="#streaming-and-event-driven"></a>
</h3>
<p><code>maestro</code> does not support streaming (i.e., continuous) or
event-driven pipelines. Only batch processes can be run in
<code>maestro</code>.</p>
</div>
<div class="section level3">
<h3 id="hundreds-of-pipelines">Hundreds of pipelines<a class="anchor" aria-label="anchor" href="#hundreds-of-pipelines"></a>
</h3>
<p>Although there is no hard limit to the number of pipelines you can
run in <code>maestro</code> (and there are ways of maximizing its
efficiency as the number of pipelines increases, such as using multiple
cores), we advise against using <code>maestro</code> to run
<em>this</em> many pipelines - at least not in a single project. There
are several reasons for this: (1) the orchestrator execution time will
be become a problem even with multiple cores; (2) organizing and keeping
track of this many pipelines in a single R project becomes difficult;
(3) the number of dependencies to manage in the project will likely
balloon.</p>
<p>If you wish to continue using <code>maestro</code> in this scenario,
then our recommendation is to split the jobs into multiple projects all
running on <code>maestro</code>.</p>
<p>Nevertheless, if you have hundreds of jobs to run it’s likely an
indicator that your enterprise has matured out of <code>maestro</code>
into something a bit more sophisticated.</p>
</div>
<div class="section level3">
<h3 id="high-frequency-jobs">High frequency jobs<a class="anchor" aria-label="anchor" href="#high-frequency-jobs"></a>
</h3>
<p>If you have pipelines that need to run every minute or less you may
want to look for a solution that supports near real time or real time
data processing. The orchestrator may have trouble keeping up if it’s
scheduled to run this often.</p>
</div>
<div class="section level3">
<h3 id="multiple-languages-r-python">Multiple languages (R + Python)<a class="anchor" aria-label="anchor" href="#multiple-languages-r-python"></a>
</h3>
<p><code>maestro</code> is for R pipelines only. Using
<code>reticulate</code> may help with Python in a pinch though.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Will Hipson, Ryan Garnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
