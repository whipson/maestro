<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quick Start • maestro</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">maestro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/maestro-1-quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-2-motivation-concepts.html">Motivation and Concepts</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-3-use-cases.html">Use Cases</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-4-advanced-scheduling.html">Advanced Scheduling</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-5-directed-acyclic-graphs.html">Directed Acyclic Graphs (DAGs)</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/hello-maestro/hello-maestro.html">Hello maestro</a></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/maestro-0-2-0/maestro-0-2-0.html">0.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/maestro-0-3-0/maestro-0-3-0.html">0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/maestro-dags/main.html">0.4.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/whipson/maestro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quick Start</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/whipson/maestro/blob/main/vignettes/maestro-1-quick-start.Rmd" class="external-link"><code>vignettes/maestro-1-quick-start.Rmd</code></a></small>
      <div class="d-none name"><code>maestro-1-quick-start.Rmd</code></div>
    </div>

    
    
<p>A common task in data engineering is to automate, schedule, and
monitor multiple data processing pipelines. This is called
<strong>orchestration</strong>. <code>maestro</code> is an R package
that helps orchestrate data pipelines.</p>
<p>A fully realized <code>maestro</code> project involves the following
components and actions:</p>
<ol style="list-style-type: decimal">
<li><p>Collection of <strong>pipelines</strong> (R functions to be
orchestrated, such as batch ETL jobs)</p></li>
<li><p><strong>Orchestrator</strong> - an R script or Quarto doc that
orchestrates the pipelines and monitors them</p></li>
<li><p>A process external to R to schedule the orchestrator (e.g., cron,
Posit Connect).</p></li>
</ol>
<div class="section level3">
<h3 id="project-setup">Project Setup<a class="anchor" aria-label="anchor" href="#project-setup"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/whipson/maestro" class="external-link">maestro</a></span><span class="op">)</span></span></code></pre></div>
<p>Create a <code>maestro</code> project in an existing project or a new
project using <code><a href="../reference/create_maestro.html">create_maestro()</a></code> or the New Project wizard in
RStudio. This creates the orchestrator script and the folder of
pipelines with one sample pipeline. Your project should look something
like this:</p>
<pre><code>maestro_project
├── maestro_project.Rproj
├── orchestrator.R
└── pipelines
    ├── my_pipe.R
    └── another_pipe.R</code></pre>
</div>
<div class="section level2">
<h2 id="pipelines">Pipelines<a class="anchor" aria-label="anchor" href="#pipelines"></a>
</h2>
<p>Pipelines are the jobs you want to automate, schedule, and monitor.
For the most part, they’re regular R functions with a special sprinkling
of comments.</p>
<div class="section level3">
<h3 id="anatomy-of-a-pipeline">Anatomy of a Pipeline<a class="anchor" aria-label="anchor" href="#anatomy-of-a-pipeline"></a>
</h3>
<p>A pipeline is simply an R function with decorators called maestro
tags. Maestro tags are special code comments used for communicating the
scheduling and configuration of a pipeline to the orchestrator. Let’s
take a quick look at the sample <code>my_pipe.R</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' my_pipe maestro pipeline</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @maestroFrequency 1 day</span></span>
<span><span class="co">#' @maestroStartTime 2024-05-24</span></span>
<span><span class="co">#' @maestroTz UTC</span></span>
<span><span class="co">#' @maestroLogLevel INFO</span></span>
<span></span>
<span><span class="va">my_pipe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Pipeline code</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><code>my_pipe</code> is a function with an empty body - so right now
it won’t do anything. The comments above are interpreted by
<code>maestro</code> as “this function is scheduled to run every day
starting at 2024-05-24 (00:00:00) UTC time”.</p>
<p>maestroFrequency and maestroStartTime are the most important tags for
scheduling. Frequency is how often you want the pipeline to run and can
be formatted as a single string like hourly, daily, weekly, biweekly,
etc. or with a number and a unit (e.g., 1 day, 3 hours, etc.).</p>
<p>Note that you don’t need to provide all these tags. A single maestro
tag is enough to distinguish it as a pipeline. Pipelines missing tags
will use consistent defaults (e.g., if <code>maestroFrequency</code> is
missing the default is 1 day/daily).</p>
<p>In most use cases, the actual code inside of <code>my_pipe</code>
would be to run an ETL job (extract data from a source, transform it,
and load it into a file system or database). In technical terms, it’s
the <em>side effect</em> of the code and not its return value that is
important.</p>
<p>Here’s a more realistic, albeit impractical, example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' my_pipe maestro pipeline</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @maestroFrequency 1 day</span></span>
<span><span class="co">#' @maestroStartTime 2024-05-24</span></span>
<span><span class="co">#' @maestroTz UTC</span></span>
<span><span class="co">#' @maestroLogLevel INFO</span></span>
<span></span>
<span><span class="va">my_pipe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">random_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    letters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    numbers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">random_data</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-new-pipelines">Adding New Pipelines<a class="anchor" aria-label="anchor" href="#adding-new-pipelines"></a>
</h3>
<p>A project with a single pipeline is ok, but in <code>maestro</code>
is more useful when you have multiple jobs to run. You can add more
pipelines to your pipelines directory manually or use
<code><a href="../reference/create_pipeline.html">create_pipeline()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_pipeline.html">create_pipeline</a></span><span class="op">(</span></span>
<span>  pipe_name <span class="op">=</span> <span class="st">"another_pipeline"</span>,</span>
<span>  pipeline_dir <span class="op">=</span> <span class="st">"pipelines"</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"1 hour"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2024-05-17 15:00:00"</span>,</span>
<span>  tz <span class="op">=</span> <span class="st">"America/Halifax"</span>,</span>
<span>  log_level <span class="op">=</span> <span class="st">"ERROR"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="orchestrator">Orchestrator<a class="anchor" aria-label="anchor" href="#orchestrator"></a>
</h2>
<p>The orchestrator is the process that schedules and monitors the
pipelines.</p>
<div class="section level3">
<h3 id="anatomy-of-the-orchestrator">Anatomy of the Orchestrator<a class="anchor" aria-label="anchor" href="#anatomy-of-the-orchestrator"></a>
</h3>
<p>The orchestrator can be an R script, Quarto/RMarkdown doc, but here
we’ll use a regular R script. Here is where you’ll run
<code>maestro</code> functions. The two main functions are
<code><a href="../reference/build_schedule.html">build_schedule()</a></code> and <code><a href="../reference/run_schedule.html">run_schedule()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/whipson/maestro" class="external-link">maestro</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">schedule</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_schedule.html">build_schedule</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_schedule.html">run_schedule</a></span><span class="op">(</span></span>
<span>  <span class="va">schedule</span>,</span>
<span>  orch_frequency <span class="op">=</span> <span class="st">"1 hour"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Building the schedule gets <code>maestro</code> to look through the
pipelines in the pipelines folder and creates a schedule object. Then,
you pass that to <code><a href="../reference/run_schedule.html">run_schedule()</a></code> along with how often the
orchestrator is supposed to run. It is important to tell
<code>maestro</code> how often it’ll be checking the pipelines using the
<code>orch_frequency</code> parameter. Here, we’re informing it that the
orchestrator is running every 1 hour.</p>
<p>Importantly, it isn’t <code>maestro</code>’s job to actually run it
this often - it’s <em>your</em> job to make sure it runs at that
frequency (e.g., deploying it via cron or some cloud environment where
code can be scheduled).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The decision around how often to run the orchestrator
depends on the frequencies of the pipelines in the project. The simplest
guideline is to take the frequency of your most often recurring pipeline
and split that in half. So for example, if my most often running
pipeline runs every 1 day then my orchestrator should run every 12
hours.&lt;/p&gt;"><sup>1</sup></a></p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Will Hipson, Ryan Garnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
