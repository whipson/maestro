<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Directed Acyclic Graphs (DAGs) • maestro</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Directed Acyclic Graphs (DAGs)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">maestro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/maestro-1-quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-2-motivation-concepts.html">Motivation and Concepts</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-3-advanced-scheduling.html">Advanced Scheduling</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-4-directed-acyclic-graphs.html">Directed Acyclic Graphs (DAGs)</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-5-logging.html">Logging</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-6-deployment.html">Deployment</a></li>
    <li><a class="dropdown-item" href="../articles/maestro-7-tag-reference.html">Maestro Tag Reference</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/hello-maestro/hello-maestro.html">Hello maestro</a></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/maestro-0-2-0/maestro-0-2-0.html">0.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/maestro-0-3-0/maestro-0-3-0.html">0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/maestro-dags/main.html">0.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://whipson.github.io/data-in-flight/posts/maestro-0-6-0/maestro-0-6-0-release.html">0.6.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/whipson/maestro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="maestro-4-directed-acyclic-graphs_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="maestro-4-directed-acyclic-graphs_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="maestro-4-directed-acyclic-graphs_files/viz-1.8.2/viz.js"></script><link href="maestro-4-directed-acyclic-graphs_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="maestro-4-directed-acyclic-graphs_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Directed Acyclic Graphs (DAGs)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/whipson/maestro/blob/0.6.1/vignettes/maestro-4-directed-acyclic-graphs.Rmd" class="external-link"><code>vignettes/maestro-4-directed-acyclic-graphs.Rmd</code></a></small>
      <div class="d-none name"><code>maestro-4-directed-acyclic-graphs.Rmd</code></div>
    </div>

    
    
<p>A <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" class="external-link">directed
acyclic graph</a> or DAG is a kind of network graph where nodes are
connected by edges, and these connections cannot loop back or cycle.
Most data orchestration tools lay out a data pipeline as a DAG where
data is passed from one function to the next until it reaches the end.
This allows for more module, single-purpose functions and can make it
easier to identify where errors are occurring.</p>
<p>You can create DAG pipelines in maestro using the
<code>maestroInputs</code> and/or <code>maestroOutputs</code> tags.
Let’s see this in action.</p>
<p>We’ll create three simple pipelines. <code>start</code> outputs a
vector, <code>high_road</code> takes an input and makes it all
uppercase, <code>low_road</code> makes the input all lowercase. We use
the <code>maestroOutputs</code> tag to indicate the names of the
downstream pipelines (i.e., these pipelines use the output of the target
pipeline as input) and we use the <code>maestroInputs</code> tag to
indicate the names of pipelines that are used as input.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Specifying the outputs and inputs is redundant. You can
specify just the outputs or just the inputs if you like, but make sure
all pipelines are identified as maestro pipelines by including at least
one maestro tag (you could make use of the catch-all
&lt;code&gt;@maestro&lt;/code&gt; tag for this.&lt;/p&gt;"><sup>1</sup></a></p>
<p>Note the use of <code>.input</code> as a parameter for all pipelines
that receive an input. It is important to have this here to enable the
passing of data from inputs to outputs. It must be named
<code>.input</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' ./pipelines/dags.R</span></span>
<span><span class="co">#' @maestroOutputs high_road low_road</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'A'</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @maestroInputs start</span></span>
<span><span class="va">high_road</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.input</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">.input</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @maestroInputs start</span></span>
<span><span class="va">low_road</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.input</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">.input</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now we’ll create and run the schedule. Notice that the output in the
console will reflect the network structure of the DAG.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ./orchestrator.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/whipson/maestro" class="external-link">maestro</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">schedule</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_schedule.html">build_schedule</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_schedule.html">run_schedule</a></span><span class="op">(</span></span>
<span>  <span class="va">schedule</span>,</span>
<span>  run_all <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/get_artifacts.html">get_artifacts</a></span><span class="op">(</span><span class="va">schedule</span><span class="op">)</span></span></code></pre></div>
<div class="asciicast" style="color: #172431;font-family: 'Fira Code',Monaco,Consolas,Menlo,'Bitstream Vera Sans Mono','Powerline Symbols',monospace;line-height: 1.300000">
<pre>
                                                                                
── [2025-07-18 12:41:37]                                                        
Running pipelines <span style="color: #859900;">▶</span>                                                             
<span style="color: #859900;">✔</span> <span style="color: #268BD2;">start</span> <span style="color: #b8b8b8;">[13ms]</span>                                                                  
<span style="color: #859900;">✔</span> |-<span style="color: #268BD2;">high_road</span> <span style="color: #b8b8b8;">[27ms]</span>                                                            
<span style="color: #859900;">✔</span> |-<span style="color: #268BD2;">low_road</span> <span style="color: #b8b8b8;">[11ms]</span>                                                             
                                                                                
── [2025-07-18 12:41:37]                                                        
Pipeline execution completed <span style="color: #525252;">■</span> | 0.102 sec elapsed                              
<span style="color: #859900;">✔</span> 3 successes | <span style="color: #073642;">→</span> 0 skipped | <span style="color: #D33682;">!</span> 0 warnings | <span style="color: #DC322F;">✖</span> 0 errors | <span style="color: #2AA198;">◼</span> 3 total             
────────────────────────────────────────────────────────────────────────────────
$start                                                                          
[1] "a" "A"                                                                     
                                                                                
$high_road                                                                      
[1] "A" "A"                                                                     
                                                                                
$low_road                                                                       
[1] "a" "a"                                                                     
                                                                                
</pre>
</div>
<div class="section level2">
<h2 id="etl-example">ETL Example<a class="anchor" aria-label="anchor" href="#etl-example"></a>
</h2>
<p>A great case for using DAGs is with ETL/ELT pipelines. Each component
of extract, transform, and load could be a single element in the DAG.
Consider the example on the home page:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Example ETL pipeline</span></span>
<span><span class="co">#' @maestroFrequency 1 day</span></span>
<span><span class="co">#' @maestroStartTime 2024-03-25 12:30:00</span></span>
<span><span class="va">my_etl</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Pretend we're getting data from a source</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Get data"</span><span class="op">)</span></span>
<span>  <span class="va">extracted</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span>  </span>
<span>  <span class="co"># Transform</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Transforming"</span><span class="op">)</span></span>
<span>  <span class="va">transformed</span> <span class="op">&lt;-</span> <span class="va">extracted</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>hp_deviation <span class="op">=</span> <span class="va">hp</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Load - write to a location</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Writing"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">transformed</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"transformed_mtcars_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>It’s pretty concise, so we probably wouldn’t bother breaking it apart
in practice, but let’s do it for illustrative purposes (and also get rid
of the messaging).</p>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @maestroFrequency 1 day</span></span>
<span><span class="co">#' @maestroStartTime 2024-03-25 12:30:00</span></span>
<span><span class="co">#' @maestroOutputs transform</span></span>
<span><span class="va">extract</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Imagine this is something way more complicated, like a database call</span></span>
<span>  <span class="va">mtcars</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @maestroOutputs load</span></span>
<span><span class="va">transform</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.input</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">.input</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>hp_deviation <span class="op">=</span> <span class="va">hp</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @maestro</span></span>
<span><span class="va">load</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.input</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">.input</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"transformed_mtcars.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/whipson/maestro" class="external-link">maestro</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">schedule</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_schedule.html">build_schedule</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_schedule.html">run_schedule</a></span><span class="op">(</span></span>
<span>  <span class="va">schedule</span>,</span>
<span>  run_all <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="asciicast" style="color: #172431;font-family: 'Fira Code',Monaco,Consolas,Menlo,'Bitstream Vera Sans Mono','Powerline Symbols',monospace;line-height: 1.300000">
<pre>
                                                                                
── [2025-07-18 12:41:38]                                                        
Running pipelines <span style="color: #859900;">▶</span>                                                             
<span style="color: #859900;">✔</span> <span style="color: #268BD2;">extract</span> <span style="color: #b8b8b8;">[9ms]</span>                                                                 
<span style="color: #859900;">✔</span> |-<span style="color: #268BD2;">transform</span> <span style="color: #b8b8b8;">[13ms]</span>                                                            
<span style="color: #859900;">✔</span>   |-<span style="color: #268BD2;">load</span> <span style="color: #b8b8b8;">[10ms]</span>                                                               
                                                                                
── [2025-07-18 12:41:38]                                                        
Pipeline execution completed <span style="color: #525252;">■</span> | 0.061 sec elapsed                              
<span style="color: #859900;">✔</span> 3 successes | <span style="color: #073642;">→</span> 0 skipped | <span style="color: #D33682;">!</span> 0 warnings | <span style="color: #DC322F;">✖</span> 0 errors | <span style="color: #2AA198;">◼</span> 3 total             
────────────────────────────────────────────────────────────────────────────────
</pre>
</div>
<p>When developing these pipelines, it is helpful to visualize the
dependency structure. We can do this by calling
<code><a href="../reference/show_network.html">show_network()</a></code> on the schedule:</p>
<div class="grViz html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"extract\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,3!\"] \n  \"2\" [label = \"transform\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,2!\"] \n  \"3\" [label = \"load\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,1!\"] \n  \"1\"->\"2\" \n  \"2\"->\"3\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>

  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Will Hipson, Ryan Garnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
